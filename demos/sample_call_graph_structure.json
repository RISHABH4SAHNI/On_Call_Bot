{
  "metadata": {
    "created_at": "2024-01-20T14:00:00.000Z",
    "repository_name": "webapp-auth-service",
    "total_functions": 12,
    "analysis_approach": "call_graph",
    "graph_statistics": {
      "total_nodes": 12,
      "root_nodes": 3,
      "leaf_nodes": 4,
      "max_depth": 3,
      "total_edges": 18
    }
  },
  "call_graph": {
    "nodes": {
      "auth-001": {
        "function_metadata": {
          "name": "login_handler",
          "lookup_id": "auth-001",
          "file_path": "handlers/auth_handler.py",
          "file_name": "auth_handler.py",
          "repository_name": "webapp-auth-service",
          "module_name": "handlers.auth_handler",
          "start_line": 15,
          "end_line": 28,
          "is_async": true,
          "class_context": "AuthHandler",
          "decorators": ["@require_json", "@rate_limit"],
          "error_handling": {"has_try_catch": true}
        },
        "dependencies": ["auth-002", "auth-006"],
        "dependents": [],
        "depth_level": 0,
        "node_type": "root"
      },
      "auth-002": {
        "function_metadata": {
          "name": "authenticate_user",
          "lookup_id": "auth-002", 
          "file_path": "auth/authenticator.py",
          "file_name": "authenticator.py",
          "repository_name": "webapp-auth-service",
          "module_name": "auth.authenticator",
          "start_line": 45,
          "end_line": 67,
          "is_async": false,
          "class_context": "UserAuthenticator",
          "decorators": ["@validate_input"],
          "error_handling": {"has_try_catch": true}
        },
        "dependencies": ["auth-003", "auth-007"],
        "dependents": ["auth-001"],
        "depth_level": 1,
        "node_type": "intermediate"
      },
      "auth-003": {
        "function_metadata": {
          "name": "validate_jwt_token",
          "lookup_id": "auth-003",
          "file_path": "auth/jwt_handler.py", 
          "file_name": "jwt_handler.py",
          "repository_name": "webapp-auth-service",
          "module_name": "auth.jwt_handler",
          "start_line": 89,
          "end_line": 112,
          "is_async": false,
          "class_context": "JWTHandler",
          "decorators": ["@token_required"],
          "error_handling": {"has_try_catch": false}
        },
        "dependencies": ["auth-004", "auth-005"],
        "dependents": ["auth-002"],
        "depth_level": 2,
        "node_type": "intermediate"
      },
      "auth-004": {
        "function_metadata": {
          "name": "verify_signature",
          "lookup_id": "auth-004",
          "file_path": "auth/signature_utils.py",
          "file_name": "signature_utils.py", 
          "repository_name": "webapp-auth-service",
          "module_name": "auth.signature_utils",
          "start_line": 23,
          "end_line": 35,
          "is_async": false,
          "class_context": null,
          "decorators": [],
          "error_handling": {"has_try_catch": false}
        },
        "dependencies": [],
        "dependents": ["auth-003"],
        "depth_level": 3,
        "node_type": "leaf"
      },
      "auth-005": {
        "function_metadata": {
          "name": "check_expiration",
          "lookup_id": "auth-005",
          "file_path": "auth/token_utils.py",
          "file_name": "token_utils.py",
          "repository_name": "webapp-auth-service", 
          "module_name": "auth.token_utils",
          "start_line": 67,
          "end_line": 78,
          "is_async": false,
          "class_context": null,
          "decorators": ["@cache_result"],
          "error_handling": {"has_try_catch": true}
        },
        "dependencies": [],
        "dependents": ["auth-003"],
        "depth_level": 3,
        "node_type": "leaf"
      },
      "auth-006": {
        "function_metadata": {
          "name": "log_auth_attempt",
          "lookup_id": "auth-006",
          "file_path": "utils/audit_logger.py",
          "file_name": "audit_logger.py",
          "repository_name": "webapp-auth-service",
          "module_name": "utils.audit_logger", 
          "start_line": 145,
          "end_line": 158,
          "is_async": true,
          "class_context": "AuditLogger",
          "decorators": ["@async_retry"],
          "error_handling": {"has_try_catch": true}
        },
        "dependencies": ["auth-008"],
        "dependents": ["auth-001"],
        "depth_level": 1,
        "node_type": "intermediate"
      },
      "auth-007": {
        "function_metadata": {
          "name": "get_user_by_email",
          "lookup_id": "auth-007",
          "file_path": "models/user_model.py",
          "file_name": "user_model.py",
          "repository_name": "webapp-auth-service",
          "module_name": "models.user_model",
          "start_line": 234,
          "end_line": 248,
          "is_async": false,
          "class_context": "User",
          "decorators": ["@database_transaction"],
          "error_handling": {"has_try_catch": true}
        },
        "dependencies": ["auth-009"],
        "dependents": ["auth-002"],
        "depth_level": 2,
        "node_type": "intermediate"
      },
      "auth-008": {
        "function_metadata": {
          "name": "write_audit_log",
          "lookup_id": "auth-008",
          "file_path": "db/audit_writer.py",
          "file_name": "audit_writer.py",
          "repository_name": "webapp-auth-service",
          "module_name": "db.audit_writer",
          "start_line": 78,
          "end_line": 89,
          "is_async": true,
          "class_context": null,
          "decorators": [],
          "error_handling": {"has_try_catch": true}
        },
        "dependencies": [],
        "dependents": ["auth-006"],
        "depth_level": 2,
        "node_type": "leaf"
      },
      "auth-009": {
        "function_metadata": {
          "name": "execute_query",
          "lookup_id": "auth-009",
          "file_path": "db/connection.py",
          "file_name": "connection.py",
          "repository_name": "webapp-auth-service",
          "module_name": "db.connection",
          "start_line": 156,
          "end_line": 167,
          "is_async": false,
          "class_context": "DatabaseConnection",
          "decorators": ["@retry_on_failure"],
          "error_handling": {"has_try_catch": true}
        },
        "dependencies": [],
        "dependents": ["auth-007"],
        "depth_level": 3,
        "node_type": "leaf"
      }
    },
    "root_nodes": ["auth-001", "auth-010", "auth-011"],
    "leaf_nodes": ["auth-004", "auth-005", "auth-008", "auth-009"],
    "call_paths": [
      {
        "path": ["auth-001", "auth-002", "auth-003", "auth-004"],
        "description": "Login → Authenticate → Validate Token → Verify Signature",
        "depth": 4
      },
      {
        "path": ["auth-001", "auth-002", "auth-003", "auth-005"], 
        "description": "Login → Authenticate → Validate Token → Check Expiration",
        "depth": 4
      },
      {
        "path": ["auth-001", "auth-002", "auth-007", "auth-009"],
        "description": "Login → Authenticate → Get User → Execute Query",
        "depth": 4
      },
      {
        "path": ["auth-001", "auth-006", "auth-008"],
        "description": "Login → Log Attempt → Write Audit",
        "depth": 3
      }
    ]
  },
  "analysis_examples": {
    "dependency_analysis": {
      "target_function": "validate_jwt_token",
      "dependencies_found": 2,
      "dependency_context": [
        {
          "function": "verify_signature",
          "relationship": "direct_call",
          "depth": 1
        },
        {
          "function": "check_expiration", 
          "relationship": "direct_call",
          "depth": 1
        }
      ],
      "insights": [
        "JWT validation depends on both signature verification and expiration checking",
        "Missing error handling could cause validation failures to propagate uncaught",
        "Both dependencies are leaf functions - good for debugging isolation"
      ]
    },
    "call_path_analysis": {
      "target_function": "verify_signature",
      "paths_to_function": [
        ["login_handler", "authenticate_user", "validate_jwt_token", "verify_signature"]
      ],
      "insights": [
        "Function is 4 levels deep in authentication flow",
        "Critical path function - failure affects entire login process",
        "Consider adding circuit breaker at this level"
      ]
    }
  }
}
